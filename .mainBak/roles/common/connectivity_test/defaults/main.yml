---
# SPDX-License-Identifier: MIT-0
# Author: Jeleel Muibi (hybridops.studio)
# Created: 2025-09-09 21:39:57 UTC
# Updated: 2025-09-10 â€” Initial connectivity test defaults
#
# Purpose: Root discovery, test knobs, and centralized path configuration.

# Discover project root from playbook_dir; works whether invoked from common/playbooks/* or roles/*
_project_root: "{{ playbook_dir | regex_replace('/common/playbooks.*$', '') | regex_replace('/roles/.*$', '') }}"

# Core test knobs
ping_count: 2
connectivity_timeout: 3 # <- preferred (replaces 'timeout')
show_test_targets: false

ports:
  ssh: 22
  telnet: 23
  http: 80
  https: 443

tests_enabled:
  icmp: true
  ssh: true
  telnet: false
  http: true
  http_head: false
  https: true
  https_head: false

# Centralized paths (role-owned)
connectivity:
  paths:
    project_root: "{{ _project_root }}"
    logs_dir: "{{ _project_root }}/common/logs"
    connectivity_logs_dir: "{{ _project_root }}/common/logs/connectivity_logs"
  audit:
    report_prefix: "connectivity_report"
    json_file: "connectivity_report.json"
    jsonl_file: "connectivity_report.jsonl"
    correlation_in_filenames: false

# Back-compat (kept but not used by central writer)
timeout: 3 # legacy, still read if present
log_directory: "logs" # DEPRECATED
report_filename: "connectivity_report.json" # DEPRECATED
csv_filename: "connectivity_report.csv" # DEPRECATED
jsonl_filename: "connectivity_report.jsonl" # DEPRECATED

# Correlation ID defaults (logging-only)
connectivity_use_cid: true
connectivity_inherited_cid: "{{ correlation_id | default(egf_correlation_id | default('', true), true) | lower }}"
connectivity_env_cid: "{{ lookup('env','EGF_CORR_ID') | default('', true) | lower }}"
connectivity_cid_pre: "{{ connectivity_inherited_cid or connectivity_env_cid }}"
