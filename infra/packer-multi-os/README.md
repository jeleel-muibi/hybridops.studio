# Packer VM Templates (Proxmox)

VM template definitions for Proxmox VE using HashiCorp Packer. Build automation uses scripts from [`control/tools/provision/packer/`](../../control/tools/provision/packer/).

> **Documentation:** [HOWTO](https://docs.hybridops.studio/howtos/HOWTO_packer_proxmox_template/) · [Runbook](https://docs.hybridops.studio/runbooks/platform/packer-proxmox-template-build/) · [Toolkit](../../control/tools/provision/packer/README.md) · [ADR-0016](https://docs.hybridops.studio/adr/ADR-0016-packer-cloudinit-vm-templates/)

---

## Available Templates

| Template | OS | VMID | Build Time |
|----------|----|----- |------------|
| `ubuntu-2204` | Ubuntu 22.04 LTS | 9000 | <10 min |
| `ubuntu-2404` | Ubuntu 24.04 LTS | 9001 | <10 min |
| `rocky-9` | Rocky Linux 9 | 9002 | <10 min |
| `rocky-10` | Rocky Linux 10 | 9003 | <10 min |
| `windows-server-2022` | Windows Server 2022 | 9100 | <10 min |
| `windows-server-2025` | Windows Server 2025 | 9101 | <10 min |
| `windows-11-enterprise` | Windows 11 Enterprise | 9102 | <10 min |

---

## Structure

```
infra/packer-multi-os/
├── Makefile                          # Build targets
├── shared/
│   ├── .env                          # Generated by make init
│   ├── generic.pkr.hcl               # Universal VM builder
│   ├── variables.global.pkr.hcl      # Variable definitions
│   └── config.plugins.pkr.hcl        # Plugin requirements
├── linux/
│   ├── ubuntu/
│   │   ├── http/user-data.tpl
│   │   ├── ubuntu-22.04.pkrvars.hcl
│   │   └── ubuntu-24.04.pkrvars.hcl
│   └── rocky/
│       ├── http/ks.cfg.tpl
│       ├── rocky-9.pkrvars.hcl
│       └── rocky-10.pkrvars.hcl
└── windows/
    ├── server/
    │   ├── http/Autounattend-server.xml.pkrtpl
    │   ├── windows-server-2022.pkrvars.hcl
    │   └── windows-server-2025.pkrvars.hcl
    └── client/
        ├── http/Autounattend-client.xml.pkrtpl
        └── windows-11-enterprise.pkrvars.hcl
```

---

## Quick Start

### Initialize
```bash
make init
```
See [HOWTO: Step 2](../../docs/howtos/HOWTO_packer_proxmox_template.md#step-2-initialize-proxmox-api) for details.

### Build
```bash
make build-ubuntu-22.04
make build-rocky-9
make build-windows-server-2022
```

### Override VMID
```bash
UBUNTU22_VMID=9100 make build-ubuntu-22.04
```

---

## Make Targets

```bash
make init                        # Bootstrap Proxmox API (one-time)
make build-ubuntu-22.04          # Build Ubuntu 22.04 LTS
make build-ubuntu-24.04          # Build Ubuntu 24.04 LTS
make build-rocky-9               # Build Rocky Linux 9
make build-rocky-10              # Build Rocky Linux 10
make build-windows-server-2022   # Build Windows Server 2022
make build-windows-server-2025   # Build Windows Server 2025
make build-windows-11-enterprise # Build Windows 11 Enterprise
make validate                    # Validate all templates
make clean                       # Remove synced files
make clean-all                   # Deep clean (.env, cache)
```

---

## Documentation

- **Learning:** [HOWTO — Build Your First Packer Template](https://docs.hybridops.studio/howtos/HOWTO_packer_proxmox_template/)
- **Operations:** [Runbook — Proxmox VM Template Build](https://docs.hybridops.studio/runbooks/platform/packer-proxmox-template-build/)
- **Toolkit:** [Packer Provisioning Toolkit](../../control/tools/provision/packer/README.md)
- **Architecture:** [ADR-0016 — Packer + Cloud-Init VM Templates](https://docs.hybridops.studio/adr/ADR-0016-packer-cloudinit-vm-templates/)

---

**Maintainer:** HybridOps. Studio  
**Last Updated:** 2025-11-17 21:58 UTC
